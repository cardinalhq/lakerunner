-- 1755713265_remove_lrconfig_prefix.down.sql

-- Code generated by database migration. DO NOT EDIT.

-- Revert table name changes - add lrconfig_ prefix back

-- Revert organizations table and indexes
DROP INDEX IF EXISTS idx_organizations_enabled;
DROP INDEX IF EXISTS idx_organizations_name;
ALTER TABLE organizations RENAME TO lrconfig_organizations;
CREATE INDEX idx_lrconfig_organizations_name ON lrconfig_organizations(name);
CREATE INDEX idx_lrconfig_organizations_enabled ON lrconfig_organizations(enabled);

-- Revert organization API key mappings indexes and table
DROP INDEX IF EXISTS idx_org_api_key_mappings_org;
DROP INDEX IF EXISTS idx_org_api_key_mappings_key;
ALTER TABLE organization_api_key_mappings RENAME TO lrconfig_organization_api_key_mappings;
CREATE INDEX idx_org_api_key_mappings_key ON lrconfig_organization_api_key_mappings(api_key_id);
CREATE INDEX idx_org_api_key_mappings_org ON lrconfig_organization_api_key_mappings(organization_id);

-- Revert organization API keys indexes and table
DROP INDEX IF EXISTS idx_org_api_keys_hash;
ALTER TABLE organization_api_keys RENAME TO lrconfig_organization_api_keys;
CREATE INDEX idx_org_api_keys_hash ON lrconfig_organization_api_keys(key_hash);

-- Revert admin API keys indexes and table
DROP INDEX IF EXISTS idx_admin_api_keys_hash;
ALTER TABLE admin_api_keys RENAME TO lrconfig_admin_api_keys;
CREATE INDEX idx_admin_api_keys_hash ON lrconfig_admin_api_keys(key_hash);

-- Revert bucket prefix mappings indexes and table
DROP INDEX IF EXISTS idx_prefix_org;
DROP INDEX IF EXISTS idx_prefix_bucket_prefix_signal;
ALTER TABLE bucket_prefix_mappings RENAME TO lrconfig_bucket_prefix_mappings;
CREATE INDEX idx_prefix_bucket_prefix_signal ON lrconfig_bucket_prefix_mappings(bucket_id, signal, path_prefix text_pattern_ops);
CREATE INDEX idx_prefix_org ON lrconfig_bucket_prefix_mappings(organization_id);

-- Revert organization buckets indexes and table
DROP INDEX IF EXISTS idx_org_buckets_bucket;
DROP INDEX IF EXISTS idx_org_buckets_org;
ALTER TABLE organization_buckets RENAME TO lrconfig_organization_buckets;
CREATE INDEX idx_org_buckets_org ON lrconfig_organization_buckets(organization_id);
CREATE INDEX idx_org_buckets_bucket ON lrconfig_organization_buckets(bucket_id);

-- Revert bucket configurations indexes and table
DROP INDEX IF EXISTS idx_bucket_configs_name;
ALTER TABLE bucket_configurations RENAME TO lrconfig_bucket_configurations;
CREATE INDEX idx_bucket_configs_name ON lrconfig_bucket_configurations(bucket_name);