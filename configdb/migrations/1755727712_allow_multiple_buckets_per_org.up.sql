-- 1755727712_allow_multiple_buckets_per_org.up.sql

-- Code generated by database migration. DO NOT EDIT.

-- Remove the UNIQUE constraint on organization_id to allow organizations to access multiple buckets
-- The constraint name varies depending on when the constraint was added, so we try both possible names
DO $$
BEGIN
    -- Try to drop the constraint with the old name (before prefix removal)
    BEGIN
        ALTER TABLE organization_buckets DROP CONSTRAINT lrconfig_organization_buckets_organization_id_key;
    EXCEPTION
        WHEN undefined_object THEN
            -- Constraint doesn't exist with old name, try new name
            BEGIN
                ALTER TABLE organization_buckets DROP CONSTRAINT organization_buckets_organization_id_key;
            EXCEPTION
                WHEN undefined_object THEN
                    -- Neither constraint exists, that's fine
                    NULL;
            END;
    END;
END $$;

