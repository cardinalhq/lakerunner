-- 1756677163_fix_metric_rollup_queue_structure.up.sql

-- Code generated by database migration. DO NOT EDIT.

-- Remove ts_range column as it's not used for metric_seg lookup
ALTER TABLE metric_rollup_queue DROP COLUMN IF EXISTS ts_range;

-- Add record_count column to match metric_compaction_queue
ALTER TABLE metric_rollup_queue ADD COLUMN IF NOT EXISTS record_count BIGINT NOT NULL DEFAULT 1;

-- Add constraint that record_count must be > 0
ALTER TABLE metric_rollup_queue 
    ADD CONSTRAINT chk_mrq_record_count_positive CHECK (record_count > 0);