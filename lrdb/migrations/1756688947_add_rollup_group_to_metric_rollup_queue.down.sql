-- 1756688947_add_rollup_group_to_metric_rollup_queue.down.sql

-- Code generated by database migration. DO NOT EDIT.

-- Restore the original per-group index without rollup_group
DROP INDEX IF EXISTS idx_mrq_ready_group;
CREATE INDEX idx_mrq_ready_group
ON metric_rollup_queue (
  organization_id, dateint, frequency_ms, instance_num, slot_id, slot_count,
  priority DESC, queue_ts, id
)
WHERE claimed_at IS NULL;

-- Remove the rollup_group constraint
ALTER TABLE metric_rollup_queue DROP CONSTRAINT IF EXISTS chk_mrq_rollup_group_positive;

-- Remove the rollup_group column
ALTER TABLE metric_rollup_queue DROP COLUMN IF EXISTS rollup_group;