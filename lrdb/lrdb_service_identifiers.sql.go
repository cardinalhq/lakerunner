// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: lrdb_service_identifiers.sql

package lrdb

import (
	"context"
	"time"

	"github.com/google/uuid"
	"github.com/jackc/pgx/v5/pgtype"
)

const upsertServiceIdentifier = `-- name: UpsertServiceIdentifier :one
INSERT INTO lrdb_service_identifiers
  (organization_id, service_name, cluster_name, namespace)
  VALUES ($1, $2, $3, $4)
  ON CONFLICT (organization_id, service_name, cluster_name, namespace)
  DO UPDATE SET updated_at = now()
  RETURNING id, created_at
`

type UpsertServiceIdentifierParams struct {
	OrganizationID pgtype.UUID `json:"organization_id"`
	ServiceName    pgtype.Text `json:"service_name"`
	ClusterName    pgtype.Text `json:"cluster_name"`
	Namespace      pgtype.Text `json:"namespace"`
}

type UpsertServiceIdentifierRow struct {
	ID        uuid.UUID `json:"id"`
	CreatedAt time.Time `json:"created_at"`
}

func (q *Queries) UpsertServiceIdentifier(ctx context.Context, arg UpsertServiceIdentifierParams) (UpsertServiceIdentifierRow, error) {
	row := q.db.QueryRow(ctx, upsertServiceIdentifier,
		arg.OrganizationID,
		arg.ServiceName,
		arg.ClusterName,
		arg.Namespace,
	)
	var i UpsertServiceIdentifierRow
	err := row.Scan(&i.ID, &i.CreatedAt)
	return i, err
}
